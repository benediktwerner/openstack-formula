{% set controller = salt['grains.filter_by']({
    'Suse': {
        'pkgs': ['openstack-nova-api', 'openstack-nova-scheduler', 'openstack-nova-cert', 'openstack-nova-conductor', 'openstack-nova-consoleauth', 'openstack-nova-novncproxy', 'python-novaclient', 'iptables'],
        'services': ['openstack-nova-api', 'openstack-nova-cert', 'openstack-nova-consoleauth', 'openstack-nova-scheduler', 'openstack-nova-conductor', 'openstack-nova-novncproxy'],
    },
}, merge=salt['pillar.get']('nova:controller')) %}

{% set compute = salt['grains.filter_by']({
    'Suse': {
        'pkgs_removed': ['kernel-default-base'],
        'pkgs': ['kernel-default', 'python-openstackclient', 'openstack-nova-compute', 'genisoimage', 'qemu-kvm', 'libvirt'],
        'services': ['openstack-nova-compute', 'libvirtd'],
    },
}, merge=salt['pillar.get']('nova:compute')) %}
