{% set controller = salt['grains.filter_by']({
    'Suse': {
        'pkgs': ['openstack-nova-api', 'openstack-nova-scheduler', 'openstack-nova-cert', 'openstack-nova-conductor', 'openstack-nova-consoleauth', 'openstack-nova-novncproxy', 'python-novaclient', 'iptables'],
        'services': ['openstack-nova-api', 'openstack-nova-cert', 'openstack-nova-consoleauth', 'openstack-nova-scheduler', 'openstack-nova-conductor', 'openstack-nova-novncproxy'],
        'debug': false,
    },
}, merge=salt['pillar.get']('nova:controller')) %}
{#
{% set compute = salt['grains.filter_by']({
    'Suse': {
        'pkgs': ['openstack-nova-compute', 'python-novaclient', 'python-nova', 'sysfsutils', 'sg3_utils'],
        'services': ['messagebus', 'openstack-nova-compute', 'libvirtd'],
        'libvirt_config': 'libvirt.conf',
        'libvirt_bin': '/etc/sysconfig/libvirtd',
        'libvirt_service': 'libvirtd',
        'bind': compute_bind_defaults,
        'debug': false,
        'identity': {
            'region': 'RegionOne'
        },
        'network': {
            'region': 'RegionOne'
        },
        'heal_instance_info_cache_interval': '60',
    },
}, merge=salt['grains.filter_by']({
    'trusty': {
        'libvirt_bin': '/etc/default/libvirt-bin',
        'libvirt_service': 'libvirt-bin',
    },
}, grain='oscodename', merge=salt['pillar.get']('nova:compute'))) %}
#}
